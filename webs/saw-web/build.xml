<?xml version="1.0"?>
<project name="web" basedir="." default="deploy">
	<import file="../build-common-web.xml"/>
	<target name="war" depends="compile">
		<mkdir dir="${project.dir}/dist" />

		<if>
			<available file="tmp" />
			<then>
				<property name="docroot.dir" value="tmp" />
			</then>
			<else>
				<property name="docroot.dir" value="docroot" />
			</else>
		</if>

		<delete file="${plugin.file}" />

		<antcall target="build-common-plugin.clean-portal-dependencies" />
		
		<zip
			basedir="${docroot.dir}"
			destfile="${plugin.file}"	
			excludes="WEB-INF/classes/META-INF/hibernate-spring.xml,WEB-INF/classes/META-INF/infrastructure-spring.xml,			WEB-INF/classes/META-INF/portlet-model-hints.xml,WEB-INF/classes/META-INF/portlet-hbm.xml,			WEB-INF/classes/META-INF/base-spring.xml,WEB-INF/src/META-INF/base-spring.xml,WEB-INF/src/META-INF/hibernate-spring.xml,
			WEB-INF/src/META-INF/infrastructure-spring.xml,WEB-INF/src/META-INF/portlet-model-hints.xml,WEB-INF/src/META-INF/portlet-hbm.xml"
		/>
		
	</target>
</project>