Liferay.KnowledgeBase={initEditArticle:function(B){var A=this;A.namespace=B.namespace;A.templateURL=B.templateURL;A.applyTemplateButton=jQuery("#"+A.namespace+"applyTemplateButton");A.templateContent=jQuery("#"+A.namespace+"templateContent");A.loadBlankTemplate()},initViewArticle:function(B){var A=this;A.articleResourcePrimKey=B.articleResourcePrimKey;A.averageScore=B.averageScore;A.namespace=B.namespace;A.feedbackURL=B.feedbackURL;A.score=B.score;A.userId=B.userId;A.textAverage=B.textAverage;A.textNo=B.textNo;A.textSuccess=B.textSuccess;A.textThanksComment=B.textThanksComment;A.textThanksVote=B.textThanksVote;A.textUpdateFeedback=B.updateFeedback;A.textVote=B.textVote;A.textVotes=B.textVotes;A.textYes=B.textYes;A.averageRating=jQuery("#"+A.namespace+"averageRating");A.comments=jQuery("#"+A.namespace+"comments");A.commentsMessage=jQuery("#"+A.namespace+"commentsMessage");A.ctrlHolderFeedbackComments=jQuery("#"+A.namespace+"ctrlHolderFeedbackComments");A.feedbackContainer=jQuery("#"+A.namespace+"feedbackContainer");A.feedbackForm=jQuery("#"+A.namespace+"feedbackForm");A.feedbackStatus=jQuery("#"+A.namespace+"feedbackStatus");A.feedbackUpdateLink=jQuery("#"+A.namespace+"feedbackUpdateLink");A.noPercentage=jQuery("#"+A.namespace+"noPercentage");A.totalEntries=jQuery("#"+A.namespace+"totalEntries");A.totalVotes=jQuery("#"+A.namespace+"totalVotes");A.yesPercentage=jQuery("#"+A.namespace+"yesPercentage");A.loadScore()},getTemplate:function(B){var A=this;if(B==""){A.loadBlankTemplate()}else{jQuery.ajax({url:A.templateURL,data:{actionName:"get_template",templateResourcePrimKey:B},dataType:"json",success:function(C){A.templateContent.html(C.content);A.templateContent.show();A.applyTemplateButton.show()}})}},loadBlankTemplate:function(){var A=this;document.getElementById(A.namespace+"templates").selectedIndex=0;A.templateContent.hide();A.applyTemplateButton.hide()},loadScore:function(){var A=this;knowledgeBaseYourRatingObj=new Liferay.Portal.StarRating(A.namespace+"yourRating",{rating:A.score,onComplete:function(B){jQuery.ajax({url:A.feedbackURL,data:{actionName:"feedback_score",articleResourcePrimKey:A.articleResourcePrimKey,score:B,userId:A.userId},dataType:"json",success:function(D){var C=(D.totalScoreEntries==1)?A.textAverage+" ("+D.totalScoreEntries+" "+A.textVote+")":A.textAverage+" ("+D.totalScoreEntries+" "+A.textVotes+")";A.totalEntries.html(C);A.averageRating.removeAttr("onmousemove");knowledgeBaseAverageRatingObj.display(D.averageScore)}})}});knowledgeBaseAverageRatingObj=new Liferay.Portal.StarRating(A.namespace+"averageRating",{displayOnly:true,rating:A.averageScore})},saveFeedbackComments:function(){var A=this;jQuery.ajax({url:A.feedbackURL,data:{actionName:"feedback_comments",articleResourcePrimKey:A.articleResourcePrimKey,comments:A.comments.val(),userId:A.userId},dataType:"json",success:function(B){A.feedbackStatus.attr("class","portlet-msg-success");A.feedbackStatus.text(A.textThanksComment);A.feedbackForm.hide()}})},saveFeedbackVote:function(B){var A=this;jQuery.ajax({url:A.feedbackURL,data:{actionName:"feedback_vote",articleResourcePrimKey:A.articleResourcePrimKey,userId:A.userId,vote:B},dataType:"json",success:function(F){var D=(F.totalVotes==1)?"("+F.totalVotes+" "+A.textVote+")":"("+F.totalVotes+" "+A.textVotes+")";var C=parseInt((F.yesVotes/F.totalVotes)*100);var E=100-C;A.feedbackStatus.attr("class","portlet-msg-success");A.feedbackStatus.text(A.textSuccess);A.yesPercentage.text(C+"%");A.noPercentage.text(E+"%");A.totalVotes.text(D);if(B==1){A.commentsMessage.text(A.textYes)}else{A.commentsMessage.text(A.textNo)}A.feedbackStatus.animate({opacity:1},1500).fadeOut(500,function(){A.feedbackStatus.css({display:""});A.feedbackStatus.attr("class","portlet-msg-info");A.feedbackStatus.text(A.textThanksVote)});A.ctrlHolderFeedbackComments.show()}})},updateLink:function(){var A=this;A.feedbackStatus.text(A.textUpdateFeedback);A.feedbackContainer.show();A.feedbackUpdateLink.hide()}}