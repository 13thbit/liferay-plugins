<?xml version="1.0"?>

<project name="sample-seam-portlet" basedir="." default="deploy">
	<import file="../build-common-portlet.xml" />

	<property name="plugin.version" value="1" />
	<property name="plugin.file" value="${project.dir}/dist/${ant.project.name}-${lp.version}.${plugin.version}.war" />

	<!--
	The original .WAR file is generated by executing the following on the command line:
		ant deploy.tomcat
	from this folder:
	C:\...\jboss-seam-1.2.1.GA\examples\registration

	See http://www.jboss.com/products/seam for more information.
	-->

	<property name="original.war.file" value="jboss-seam-registration.war" />

	<target name="compile">

		<!--
		Need to merge first, so that the original .WAR file will be
		extracted. This is a prerequisite for deleting the files below
		-->

		<antcall target="build-common-plugin.merge" />
		<if>
			<available file="tmp" />
			<then>

				<!--
				The following file must be deleted because it is
				already present in the classpath of the application 
				server. Also, having it present in the WEB-INF/lib
				folder of the WAR causes classloader problems.
				-->

				<delete file="tmp/WEB-INF/lib/portlet-api-lib.jar"/>

				<!--
				The following JARs are not necessary to for the example
				to run properly. In addition, LEP-3144 makes deleting
				these files a necessity for now.
				-->

				<delete>
					<fileset dir="tmp/WEB-INF/lib">
						<include name="activation.jar"/>
						<include name="ajax4jsf-1.1.1-SNAPSHOT.jar"/>
						<include name="el-api.jar"/>
						<include name="el-ri.jar"/>
						<include name="itext-2.0.1.jar"/>
						<include name="jcaptcha-all-1.0-RC4.jar"/>
						<include name="jstl-1.1.0.jar"/>
						<include name="mail-ra.jar"/>
						<include name="mail.jar"/>
						<include name="oscache-2.3.2.jar"/>
						<include name="richfaces-3.0.1-SNAPSHOT.jar"/>
						<include name="spring.jar"/>
					</fileset>
				</delete>
			</then>
		</if>

		<antcall target="build-common-plugin.compile" />
	</target>
</project>