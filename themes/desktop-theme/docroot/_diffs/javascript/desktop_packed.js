var Desktop=function(){var A=jQuery;return{initHtml:function(){var B=this;if(A("#content-wrapper").hasClass("freeform")){B._handleBodyClicks()}else{B._handleAddScrollbar()}},initPage:function(){var B=this;B._handleAddSidebar();B._handlePortletIcons();if(A("#content-wrapper").is(".freeform")){B._handlePortletSelect();B._handlePortletClicks()}},tbAddLink:function(F){var J=this;if(A("#tb_"+F).size()==0){var I=A("#p_p_id_"+F+"_");var D=I.find("span.icon-close");var C="";if(I.hasClass("portlet-minimized")){I.css({display:"none"}).removeClass("portlet-minimized");C="javascript: Desktop.portletRestore('"+F+"');"}else{C="javascript: Desktop.portletMinimize('"+F+"');"}if(D.size()==0){C="#"}var H=A.trim(I.find("span.portlet-title").text());if(H!=""){var B="";B+="<li id=\"tb_"+F+"\" class=\"taskbar-link\">";B+="\t<a href=\""+C+"\">";B+="\t\t<span class=\"taskbar-link-title\">";B+=H;B+="\t\t</span>";B+="\t</a>";B+="</li>";A("#taskbar-portlets").append(B);var G=A("#taskbar-portlets .taskbar-link");var E=G.size();G.css({width:100/E+"%"})}if(A("#content-wrapper").is(".freeform")){J.portletRestore(F)}}},tbSelectLink:function(D){var B=this;var C=A("#tb_"+D);if(C.size()>0){A(".taskbar-link.selected").removeClass("selected");C.addClass("selected")}},portletMaximize:function(D){var C=this;var E=0;A(window).load(function(){if(A("html").is(".ie6")){E=document.documentElement.offsetHeight-4}else{if(A("html").is(".ie")){E=document.body.offsetHeight}else{E=window.innerHeight}}A("#portlet-wrapper-"+D+" .middle-center").css({height:E-68+"px"})});if(A("html").is(".ie")){var B=null;A(window).resize(function(){if(B){clearTimeout(B)}B=setTimeout(function(){if(A("html").is(".ie6")){E=document.documentElement.offsetHeight-4}else{E=document.body.offsetHeight}A("#portlet-wrapper-"+D+" .middle-center").css({height:E-68+"px"})},100)})}else{A(window).resize(function(){A("#portlet-wrapper-"+D+" .middle-center").css({height:window.innerHeight-68+"px"})})}},portletMinimize:function(C){var B=this;var D=A("#tb_"+C+" a").attr("href");D=D.replace("portletMinimize","portletRestore");A("#tb_"+C+" a").attr("href",D);A("#p_p_id_"+C+"_").css({display:"none"});A.ajax({url:themeDisplay.getPathMain()+"/portal/update_layout",data:{p_l_id:themeDisplay.getPlid(),p_p_id:C,p_p_restore:false,doAsUserId:themeDisplay.getDoAsUserIdEncoded(),cmd:"minimize"}})},portletRemove:function(D,C){var B=this;A("#tb_"+D).remove();var E=A("#taskbar-portlets .taskbar-link").size()-1;if(E<1){E=1}A("#taskbar-portlets .taskbar-link").css({width:100/E+"%"});var F=A("#p_p_id_"+D+"_");F.portletProcessed=true;F.portletId=D;F.columnPos=C;Liferay.Portlet.close(F,true)},portletRestore:function(D){var B=this;var H=A("#tb_"+D+" a").attr("href");H=H.replace("portletRestore","portletMinimize");A("#tb_"+D+" a").attr("href",H);var G=A("#p_p_id_"+D+"_");var F=G.parent().attr("id");if(A("#content-wrapper").is(".freeform")){G.appendTo("#"+F);G.css({display:""})}else{G.css({display:""})}var E="tb_"+D;var C=A(".taskbar-link.selected").attr("id");if((E!=C)&&A("#content-wrapper").is(".freeform")){B.tbSelectLink(D)}A.ajax({url:themeDisplay.getPathMain()+"/portal/update_layout",data:{p_l_id:themeDisplay.getPlid(),p_p_id:D,p_p_restore:true,doAsUserId:themeDisplay.getDoAsUserIdEncoded(),cmd:"minimize"}})},_handleAddScrollbar:function(){var B=this;A("html").css({overflow:"auto"});A("#wrapper").css({"min-width":"964px"})},_handleAddSidebar:function(){var B=this;var C=A("#sidebar-container");var D=A("#sidebar-link");if((C.size()>0)&&(D.size()==0)){var E="";E+="<div id=\"sidebar-link\">";E+="\t<a href=\"javascript: Sidebar.animate();\"></a>";E+="</div>";C.prepend(E).css({display:""});Sidebar.toggle("87",false)}},_handleBodyClicks:function(){var B=this;A("body").click(function(D){var C=A(D.target);if(C.is("#wrapper")){A(".taskbar-link.selected").removeClass("selected")}})},_handlePortletClicks:function(){var B=this;var C=A("div.portlet-boundary");C.click(function(F){var D=C.index(this);var E="";E=C.eq(D).attr("id");E=E.substring(0,E.length-1);E=E.replace("p_p_id_","");B.tbSelectLink(E)})},_handlePortletIcons:function(){var B=this;A("div.portlet-boundary").find("span.portlet-icons a").hoverIntent({sensitivity:4,interval:50,timeout:0,over:function(){A(this).addClass("selected")},out:function(){A(this).removeClass("selected")}})},_handlePortletSelect:function(){var B=this;var D=A("#content-wrapper").find("div.portlet-boundary:last");var C="";if(D.size()>0){C=D.attr("id");C=C.substring(0,C.length-1);C=C.replace("p_p_id_","");B.tbSelectLink(C)}}}}()