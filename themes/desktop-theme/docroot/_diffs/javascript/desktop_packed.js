var Desktop=function(){var B=jQuery;var A=themeDisplay.isFreeformLayout();return{initHtml:function(){var C=this;if(A){C._handleBodyClicks()}else{C._handleAddScrollbar()}},initPage:function(){var C=this;C._handleAddSidebar();C._handlePortletIcons();if(A){C._handleTaskbarInit();C._handlePortletClicks()}},taskbarAddPortlet:function(G){var K=this;if(B("#tb_"+G).size()==0){var J=B("#p_p_id_"+G+"_");var E=J.find("span.icon-close");var D="";if(J.hasClass("portlet-minimized")){J.css({display:"none"}).removeClass("portlet-minimized");D="javascript: Desktop.portletRestore('"+G+"');"}else{D="javascript: Desktop.portletMinimize('"+G+"');"}if(E.size()==0){D="#"}var I=B.trim(J.find("span.portlet-title").text());if(I!=""){var C="";C+="<li id=\"tb_"+G+"\" class=\"taskbar-link\">";C+="\t<a href=\""+D+"\">";C+="\t\t<span class=\"taskbar-link-title\">";C+=I;C+="\t\t</span>";C+="\t</a>";C+="</li>";B("#taskbar-portlets").append(C);var H=B("#taskbar-portlets .taskbar-link");var F=H.size();H.css({width:100/F+"%"})}if(A){K.portletRestore(G)}}},taskbarSelectedPortlet:function(E){var C=this;var D=B("#tb_"+E);if(D.size()>0){B(".taskbar-link.selected").removeClass("selected");D.addClass("selected")}},portletMaximize:function(E){var D=this;var F=0;B(window).load(function(){if(B("html").is(".ie6")){F=document.documentElement.offsetHeight-4}else{if(B("html").is(".ie")){F=document.body.offsetHeight}else{F=window.innerHeight}}B("#portlet-wrapper-"+E+" .middle-center").css({height:F-68+"px"})});if(B("html").is(".ie")){var C=null;B(window).resize(function(){if(C){clearTimeout(C)}C=setTimeout(function(){if(B("html").is(".ie6")){F=document.documentElement.offsetHeight-4}else{F=document.body.offsetHeight}B("#portlet-wrapper-"+E+" .middle-center").css({height:F-68+"px"})},100)})}else{B(window).resize(function(){B("#portlet-wrapper-"+E+" .middle-center").css({height:window.innerHeight-68+"px"})})}},portletMinimize:function(D){var C=this;var E=B("#tb_"+D+" a").attr("href");E=E.replace("portletMinimize","portletRestore");B("#tb_"+D+" a").attr("href",E);B("#p_p_id_"+D+"_").css({display:"none"});B.ajax({url:themeDisplay.getPathMain()+"/portal/update_layout",data:{p_l_id:themeDisplay.getPlid(),p_p_id:D,p_p_restore:false,doAsUserId:themeDisplay.getDoAsUserIdEncoded(),cmd:"minimize"}})},portletRemove:function(E,D){var C=this;B("#tb_"+E).remove();var F=B("#taskbar-portlets .taskbar-link").size()-1;if(F<1){F=1}B("#taskbar-portlets .taskbar-link").css({width:100/F+"%"});var G=B("#p_p_id_"+E+"_");G.portletProcessed=true;G.portletId=E;G.columnPos=D;Liferay.Portlet.close(G,true)},portletRestore:function(E){var C=this;var I=B("#tb_"+E+" a").attr("href");I=I.replace("portletRestore","portletMinimize");B("#tb_"+E+" a").attr("href",I);var H=B("#p_p_id_"+E+"_");var G=H.parent().attr("id");if(A){H.appendTo("#"+G);H.css({display:""})}else{H.css({display:""})}H.find("span.portlet-icons a").removeClass("selected");var F="tb_"+E;var D=B(".taskbar-link.selected").attr("id");if((F!=D)&&A){C.taskbarSelectedPortlet(E)}B.ajax({url:themeDisplay.getPathMain()+"/portal/update_layout",data:{p_l_id:themeDisplay.getPlid(),p_p_id:E,p_p_restore:true,doAsUserId:themeDisplay.getDoAsUserIdEncoded(),cmd:"minimize"}})},_handleAddScrollbar:function(){var C=this;B("html").css({overflow:"auto"});B("#wrapper").css({"min-width":"964px"})},_handleAddSidebar:function(){var C=this;var D=B("#sidebar-container");var E=B("#sidebar-link");if((D.size()>0)&&(E.size()==0)){var F="";F+="<div id=\"sidebar-link\">";F+="\t<a href=\"javascript: Sidebar.animate();\"></a>";F+="</div>";D.prepend(F).css({display:""});Sidebar.toggle("87",false)}},_handleBodyClicks:function(){var C=this;B("body").click(function(E){var D=B(E.target);if(D.is("#wrapper")){B(".taskbar-link.selected").removeClass("selected")}})},_handlePortletClicks:function(){var C=this;var D=B("div.portlet-boundary");D.click(function(G){var E=D.index(this);var F="";F=D.eq(E).attr("id");F=F.substring(0,F.length-1);F=F.replace("p_p_id_","");C.taskbarSelectedPortlet(F)})},_handlePortletIcons:function(){var C=this;B("div.portlet-boundary").find("span.portlet-icons a").hoverIntent({interval:0,timeout:0,over:function(){B(this).addClass("selected")},out:function(){B(this).removeClass("selected")}})},_handleTaskbarInit:function(){var C=this;var E=B("#content-wrapper").find("div.portlet-boundary:last");var D="";if(E.size()>0){D=E.attr("id");D=D.substring(0,D.length-1);D=D.replace("p_p_id_","");C.taskbarSelectedPortlet(D)}}}}()